<!DOCTYPE html>
<html>

<!-- <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>框架</title>
    <link rel="stylesheet" href="../layui/css/layui.css">
    <script src="../echarts.js"></script>
    <script src="../echarts-gl.js"></script>
</head> -->

<body>
    <div class="layui-row">
        <div class="layui-col-md3">
            <div style="text-align:center; line-height:120px; font-weight:bold; font-size: larger;" name="nowTime">时间</div>
        </div>
        <div class="layui-col-md2">
            <form class="layui-form" action="">
                <div class="layui-form-item">
                    <input type="radio" name="status" value="0" title="实时检测">
                    <input type="radio" name="status" value="1" title="当前查询" checked>
                    <input type="radio" name="status" value="2" title="历史查询">
                </div>
            </form>
        </div>
        <div class="layui-col-md2">
            <div class="layui-form">
                <div class="layui-form-item">
                    <div class="layui-inline">
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" id="time1" placeholder="yyyy-MM-dd HH:mm:ss">
                            <input type="text" class="layui-input" id="time2" placeholder="yyyy-MM-dd HH:mm:ss">
                            <button type="button" class="layui-btn layui-btn-sm layui-btn-fluid layui-btn-normal" style="margin-top: 5px;">检索</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-col-md5">
        </div>
    </div>
    <div class="layui-row" id="view"></div>
    <script id="demo" type="text/html">
    {{#  layui.each(d.list, function(index, item){ }}
        {{#
            var _id = item.id;
        }}
      <div class="layui-col-md6" style="border-style: solid;">
        <div class="layui-row">
            <div class="layui-col-md4">
                <form class="layui-form" action="">
                    <select lay-filter="">
                            {{#  layui.each(d.list, function(index, item){ }}
                                {{#  if (_id == item.id){ }}
                                    <option value={{_id +'_' + item.id}} selected>{{item.title}}</option>
                                {{#  }else{ }}
                                    <option value={{_id +'_' + item.id}}>{{item.title}}</option>
                                {{#  } }}
                            {{#  }); }}
                    </select>
                </form>
            </div>
            <div class="layui-col-md4" name="nowTime">时间</div>
            <div class="layui-col-md4">转速</div>
        </div>
        <div class="layui-row">
          <div class="layui-col-md12" id={{item.id}} style=height:400px;></div>
        </div>
      </div>
    {{#  }); }}
    </script>
    <!-- <script src="../layui/layui.js"></script> -->
    <script>
        layui.use('laydate', function () {
            var laydate = layui.laydate;
            laydate.render({
                elem: '#time1'
                , value: '2019-10-10 06:01:00'
                , isInitValue: true
                , type: 'datetime'
            });
            laydate.render({
                elem: '#time2'
                , value: '2020-02-10 14:01:00'
                , isInitValue: true
                , type: 'datetime'
            });
        });
        new Promise(function (resolve, reject) {
            layui.use('laytpl', function () {
                var laytpl = layui.laytpl
                var getTpl = demo.innerHTML
                var view = document.getElementById('view');
                var tableData = {
                    'list': checkedList
                }
                laytpl(getTpl).render(tableData, function (html) {
                    view.innerHTML = html;
                });
            });
            resolve();
        }).then(function () {
            layui.use(['form'], function () {
                var $ = layui.$
                var form = layui.form;
                form.render('select')
                $(document).ready(function () {
                    for (var i = 0; i < checkedList.length; i++) {
                        draw(checkedList[i].id);
                    }
                })
            });
        })
        layui.use('form', function () {
            var form = layui.form;

            //监听提交
            form.on('select()', function (data) {
                var x = data.value.indexOf('_')
                var id1 = data.value.substr(0,x)
                var id2 = data.value.substr(x+1)
                draw(id1)
            });
        });
        function draw(id) {
            // echarts
            var data = [];
            for (let i = 0; i < 300; i++) {
                if (i%19==0){ data[i] = [i/300, 0] }
                else if (i%19==1){ data[i] = [i/300, 0.01] }
                else if (i%19==2){ data[i] = [i/300, 0] }
                else if (i%19==3){ data[i] = [i/300, 0.01 + (Math.random()-0.5)/500] }
                else if (i%19==4){ data[i] = [i/300, 0.015 + (Math.random()-0.5)/500] }
                else if (i%19==5){ data[i] = [i/300, 0.026 + (Math.random()-0.5)/500] }
                else if (i%19==6){ data[i] = [i/300, 0.026 + (Math.random()-0.5)/500] }
                else if (i%19==7){ data[i] = [i/300, 0] }
                else if (i%19==8){ data[i] = [i/300, 0] }
                else if (i%19==9){ data[i] = [i/300, 0] }
                else if (i%19==10){ data[i] = [i/300, 0] }
                else if (i%19==11){ data[i] = [i/300, 0] }
                else if (i%19==12){ data[i] = [i/300, 0] }
                else if (i%19==13){ data[i] = [i/300, 0] }
                else if (i%19==14){ data[i] = [i/300, 0] }
                else if (i%19==15){ data[i] = [i/300, 0] }
                else if (i%19==16){ data[i] = [i/300, -0.02 + (Math.random()-0.5)/500] }
                else if (i%19==17){ data[i] = [i/300, -0.023 + (Math.random()-0.5)/500] }
                else if (i%19==18){ data[i] = [i/300, -0.06 + (Math.random()-0.5)/500] }
            }
            // 指定图表的配置项和数据
            var option = {
                tooltip: {},
                xAxis: {
                    type: 'value',
                    name: "时间/s",
                    nameLocation: 'middle'
                },
                yAxis: {
                    type: 'value',
                    name: "幅值/g",
                    nameLocation: 'middle',
                    max: 0.04,
                    min: -0.08,
                    nameGap: 40
                },
                series: [
                    {
                        data: data,
                        type: 'line',
                        lineStyle: {
                            color: 'blue'
                        },
                        showSymbol: false,
                        markPoint: {
                            data: [
                                {
                                    x: '90%',
                                    y: '10%',
                                    value: "x=0.00s\ny=0.00g",
                                    symbol: 'roundRect',
                                    label: {
                                        color: '#000'
                                    },
                                    itemStyle: {
                                        color: 'rgba(255,255,255,0)',
                                    }
                                },
                                {
                                    x: '15%',
                                    y: '10%',
                                    value: "峰值：0.026g 有效值0.129g",
                                    symbol: 'roundRect',
                                    label: {
                                        color: '#000'
                                    },
                                    itemStyle: {
                                        color: 'rgba(255,255,255,0)',
                                    }
                                }
                            ]
                        },
                    }
                ]
            };
            echarts.init(document.getElementById(id)).setOption(option);
        };
    </script>
</body>