<!DOCTYPE html>
<html>

<!-- <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>框架</title>
    <link rel="stylesheet" href="../layui/css/layui.css">
    <script src="../echarts.js"></script>
    <script src="../echarts-gl.js"></script>
</head> -->

<body>
    <div class="layui-row">
        <div class="layui-col-md3">
            <div style="text-align:center; line-height:120px; font-weight:bold; font-size: larger;" name="nowTime">时间</div>
        </div>
        <div class="layui-col-md2">
            <form class="layui-form" action="">
                <div class="layui-form-item">
                    <input type="radio" name="status" value="0" title="实时检测">
                    <input type="radio" name="status" value="1" title="当前查询" checked>
                    <input type="radio" name="status" value="2" title="历史查询">
                </div>
            </form>
        </div>
        <div class="layui-col-md2">
            <div class="layui-form">
                <div class="layui-form-item">
                    <div class="layui-inline">
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" id="time1" placeholder="yyyy-MM-dd HH:mm:ss">
                            <input type="text" class="layui-input" id="time2" placeholder="yyyy-MM-dd HH:mm:ss">
                            <button type="button" class="layui-btn layui-btn-sm layui-btn-fluid layui-btn-normal" style="margin-top: 5px;">检索</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-col-md5">
        </div>
    </div>
    <div class="layui-row" id="viewTrend">
        <div class="layui-col-md8" style="border-style: solid;">
            <div class="layui-row">
                <div class="layui-col-md4" name="nowTime">时间</div>
                <div class="layui-col-md4">转速</div>
            </div>
            <div class="layui-row">
                <div class="layui-col-md12" id="trend" style=height:600px;></div>
            </div>
        </div>
        <div class="layui-col-md4" style="border-style: solid;">
            <form class="layui-form" action="">
                <div class="layui-form-item layui-row">
                    <div class="layui-col-md12">
                        <form class="layui-form" action="">
                            <select id="sss" lay-filter="">
                            </select>
                        </form>
                    </div>

                    <div class="layui-col-md12">振动指标</div>

                    <div class="layui-col-md4 layui-row">
                        <div class="layui-col-md12"><input type="checkbox" name="" title="有效值" lay-skin="primary"
                                lay-filter="trend" checked></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="峰峰值" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="峰值" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="峰值指标" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="峭度指标" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="偏度系数" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="裕度指标" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="脉冲指标" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="波形指标" lay-skin="primary"
                                lay-filter="trend"></div>
                    </div>
                    <div class="layui-col-md4 layui-row">
                        <div class="layui-col-md12"><input type="checkbox" name="" title="0.5X幅值" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="0.5X相位" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="1X幅值" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="1X相位" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="2X幅值" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="2X相位" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="3X幅值" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="3X相位" lay-skin="primary"
                                lay-filter="trend"></div>
                    </div>
                    <div class="layui-col-md4 layui-row">
                        <div class="layui-col-md12"><input type="checkbox" name="" title="重心频率" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="均方频率" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="均方根频率" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="频率方案" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="频率标准差" lay-skin="primary"
                                lay-filter="trend"></div>
                        <div class="layui-col-md12"><input type="checkbox" name="" title="气隙Gap" lay-skin="primary"
                                lay-filter="trend"></div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <script src="../layui/layui.js"></script>
    <script>
        var datasetTrend = { "有效值": [] };

        var tableTrend;
        layui.use('laydate', function () {
            var laydate = layui.laydate;
            laydate.render({
                elem: '#time1'
                , value: '2019-10-10 06:01:00'
                , isInitValue: true
                , type: 'datetime'
            });
            laydate.render({
                elem: '#time2'
                , value: '2020-02-10 14:01:00'
                , isInitValue: true
                , type: 'datetime'
            });
        });
        layui.use(['form'], function () {
            var form = layui.form;
            //此处即为 checkbox 的监听事件
            form.on('checkbox(trend)', function (obj) {
                var title = obj.elem.title
                if (title == '峰峰值'){
                    var data = [];
                    var r = 10 * Math.random()
                    for (let i = 0; i < 1000; i++) {
                        data[i] = [datasetTrend['峰值'][i][0], datasetTrend['峰值'][i][1]*2];
                    }
                    datasetTrend[title] = data;
                }
                else if (datasetTrend[title] == null) {
                    var data = [];
                    var r = 0.045
                    for (let i = 0; i < 1000; i++) {
                        if (i>650){
                            if (i<730){
                                r = 0.051
                            }
                            else{
                                r = 0.047
                            }
                        }
                        data[i] = [new Date(1671000649685+i*50000).toLocaleString(), r + Math.random()*0.005];
                    }
                    datasetTrend[title] = data;
                }
                else {
                    delete datasetTrend[title];
                }
                var option = {
                    tooltip: {
                        trigger: 'none',
                        axisPointer: {
                            type: 'cross'
                        }
                    },
                    xAxis: {
                        type: 'category',
                        name: "时间/年-月-日 时：分",
                        nameLocation: 'middle',
                        nameGap: 40
                    },
                    yAxis: {
                        type: 'value',
                        name: "值/g",
                        nameLocation: 'middle',
                        nameGap:40,
                        min: 0,
                        max: 0.15
                    },
                    series: []
                };
                for (var key in datasetTrend) {
                    option.series.push({
                        name: key,
                        data: datasetTrend[key],
                        type: 'line',
                        showSymbol: false
                    })
                }
                tableTrend.setOption(option, true);
            });
        });
        drawTrend();
        initName();
        function initName() {
            var slct = document.getElementById("sss");
            for (var i in checkedList) {
                var op = document.createElement("option")
                op.setAttribute('value', checkedList[i].id)
                op.innerHTML = checkedList[i].title;
                slct.appendChild(op)
            }
            layui.use(['form'], function () {
                layui.form.render('select')
            });
        }
        function drawTrend() {
            tableTrend = echarts.init(document.getElementById("trend"))
            // echarts
            var data = [];
            var r = 0.045
            for (let i = 0; i < 1000; i++) {
                if (i > 650) {
                    if (i < 730) {
                        r = 0.051
                    }
                    else {
                        r = 0.047
                    }
                }
                data[i] = [new Date(1671000649685 + i * 50000).toLocaleString(), r + Math.random() * 0.005];
            }
            datasetTrend["有效值"] = data;
            // 指定图表的配置项和数据
            var option = {
                tooltip: {
                    trigger: 'none',
                    axisPointer: {
                        type: 'cross'
                    }
                },
                xAxis: {
                    type: 'category',
                    name: "时间/年-月-日 时：分",
                    nameLocation: 'middle',
                    nameGap: 40
                },
                yAxis: {
                    type: 'value',
                    name: "值/g",
                    nameLocation: 'middle',
                    nameGap: 40,
                    min: 0,
                    max: 0.15
                },
                series: [
                    {
                        name: "有效值",
                        data: data,
                        type: 'line',
                        showSymbol: false,
                    }
                ]
            };
            tableTrend.setOption(option);
        };
    </script>
</body>